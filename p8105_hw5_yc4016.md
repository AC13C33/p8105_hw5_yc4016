p8105_hw5_yc4016
================
Yishan Chen
2022-11-08

# Problem 1

### Question

-   Create a tidy dataframe containing data from all participants,
    including the subject ID, arm, and observations over time:
    -   Start with a dataframe containing all file names; the list.files
        function will help
    -   Iterate over file names and read in data for each subject using
        purrr::map and saving the result as a new variable in the
        dataframe
    -   Tidy the result; manipulate file names to include control arm
        and subject ID, make sure weekly observations are “tidy”, and do
        any other tidying that’s necessary
-   Make a spaghetti plot showing observations on each subject over
    time, and comment on differences between groups.

# Problem 2

``` r
homicide_df = 
  read_csv("./data/homicide-data.csv") %>% 
  mutate(city_state = str_c(city, state, sep = ", ", collapse = NULL),
         homicide_situation = case_when(disposition == "Closed without arrest" ~ "unsolved",
                                        disposition == "Open/No arrest"        ~ "unsolved",
                                        disposition == "Closed by arrest"      ~ "solved")) %>% 
  select(city_state, homicide_situation, everything()) 
```

    ## Rows: 52179 Columns: 12
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (9): uid, victim_last, victim_first, victim_race, victim_age, victim_sex...
    ## dbl (3): reported_date, lat, lon
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
homicide_df
```

    ## # A tibble: 52,179 × 14
    ##    city_st…¹ homic…² uid   repor…³ victi…⁴ victi…⁵ victi…⁶ victi…⁷ victi…⁸ city 
    ##    <chr>     <chr>   <chr>   <dbl> <chr>   <chr>   <chr>   <chr>   <chr>   <chr>
    ##  1 Albuquer… unsolv… Alb-…  2.01e7 GARCIA  JUAN    Hispan… 78      Male    Albu…
    ##  2 Albuquer… solved  Alb-…  2.01e7 MONTOYA CAMERON Hispan… 17      Male    Albu…
    ##  3 Albuquer… unsolv… Alb-…  2.01e7 SATTER… VIVIANA White   15      Female  Albu…
    ##  4 Albuquer… solved  Alb-…  2.01e7 MENDIO… CARLOS  Hispan… 32      Male    Albu…
    ##  5 Albuquer… unsolv… Alb-…  2.01e7 MULA    VIVIAN  White   72      Female  Albu…
    ##  6 Albuquer… unsolv… Alb-…  2.01e7 BOOK    GERALD… White   91      Female  Albu…
    ##  7 Albuquer… solved  Alb-…  2.01e7 MALDON… DAVID   Hispan… 52      Male    Albu…
    ##  8 Albuquer… solved  Alb-…  2.01e7 MALDON… CONNIE  Hispan… 52      Female  Albu…
    ##  9 Albuquer… unsolv… Alb-…  2.01e7 MARTIN… GUSTAVO White   56      Male    Albu…
    ## 10 Albuquer… unsolv… Alb-…  2.01e7 HERRERA ISRAEL  Hispan… 43      Male    Albu…
    ## # … with 52,169 more rows, 4 more variables: state <chr>, lat <dbl>, lon <dbl>,
    ## #   disposition <chr>, and abbreviated variable names ¹​city_state,
    ## #   ²​homicide_situation, ³​reported_date, ⁴​victim_last, ⁵​victim_first,
    ## #   ⁶​victim_race, ⁷​victim_age, ⁸​victim_sex

##### Find total number of homicides by cities and total number of unsolved homicides by cities.

``` r
homicide_number = 
  homicide_df %>% 
  group_by(city_state) %>% 
  summarize(total_homicide = n(),
            total_homicide_unsolved = sum(homicide_situation == "unsolved"))

homicide_number
```

    ## # A tibble: 51 × 3
    ##    city_state      total_homicide total_homicide_unsolved
    ##    <chr>                    <int>                   <int>
    ##  1 Albuquerque, NM            378                     146
    ##  2 Atlanta, GA                973                     373
    ##  3 Baltimore, MD             2827                    1825
    ##  4 Baton Rouge, LA            424                     196
    ##  5 Birmingham, AL             800                     347
    ##  6 Boston, MA                 614                     310
    ##  7 Buffalo, NY                521                     319
    ##  8 Charlotte, NC              687                     206
    ##  9 Chicago, IL               5535                    4073
    ## 10 Cincinnati, OH             694                     309
    ## # … with 41 more rows

``` r
baltimore = 
  homicide_number %>% 
  filter(city_state == "Baltimore, MD")

baltimore
```

    ## # A tibble: 1 × 3
    ##   city_state    total_homicide total_homicide_unsolved
    ##   <chr>                  <int>                   <int>
    ## 1 Baltimore, MD           2827                    1825

``` r
prop.test(baltimore %>% pull(total_homicide_unsolved), 
          baltimore %>% pull(total_homicide)) %>% 
broom::tidy() 
```

    ## # A tibble: 1 × 8
    ##   estimate statistic  p.value parameter conf.low conf.high method        alter…¹
    ##      <dbl>     <dbl>    <dbl>     <int>    <dbl>     <dbl> <chr>         <chr>  
    ## 1    0.646      239. 6.46e-54         1    0.628     0.663 1-sample pro… two.si…
    ## # … with abbreviated variable name ¹​alternative
